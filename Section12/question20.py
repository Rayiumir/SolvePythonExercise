import csv
from collections import defaultdict

# ูุงู ูุงู CSV ฺฉู ุดุงูู ุงุทูุงุนุงุช ูุงู ุดุฎุต ุงุณุช
csv_filename = "personal_finance.csv"

# ูุชุบุฑูุง ุจุฑุง ุฐุฎุฑู ุงุทูุงุนุงุช ูุงู
income = 0
expenses = defaultdict(float)
savings = 0
budget = {}

# ุฎูุงูุฏู ูุงู CSV
with open(csv_filename, newline='', encoding="utf-8") as csvfile:
    reader = csv.reader(csvfile)
    header = next(reader)  # ุฎูุงูุฏู ูุฏุฑ (ูุงู ุณุชููโูุง)

    for row in reader:
        category = row[0]  # ููุน (ุฏุฑุขูุฏุ ูุฒููุ ูพุณโุงูุฏุงุฒ)
        subcategory = row[1]  # ูุงู ุฏุณุชูโุจูุฏ
        amount = float(row[2])  # ููุฏุงุฑ ูพูู
        type_ = row[3]  # ููุน ุชุฑุงฺฉูุด (ุฏุฑุขูุฏ/ูุฒูู/ูพุณโุงูุฏุงุฒ)
        allocated_budget = float(row[4]) if row[4] else 0  # ุจูุฏุฌู ุชุนูโุดุฏู (ุงุฎุชุงุฑ)

        if type_ == "ุฏุฑุขูุฏ":
            income += amount
        elif type_ == "ูุฒูู":
            expenses[subcategory] += amount
            budget[subcategory] = allocated_budget
        elif type_ == "ูพุณโุงูุฏุงุฒ":
            savings += amount

# ุจุฑุฑุณ ุจูุฏุฌู ู ฺฏุฒุงุฑุด ูุถุนุช ูุงู
print("๐ ฺฏุฒุงุฑุด ูุงู ุดุฎุต")
print("-" * 50)
print(f"๐ฐ ูุฌููุน ุฏุฑุขูุฏ: {income:.2f}")
print(f"๐ธ ูุฌููุน ูุฒููโูุง: {sum(expenses.values()):.2f}")
print(f"๐ฆ ูุฌููุน ูพุณโุงูุฏุงุฒ: {savings:.2f}")

# ุจุฑุฑุณ ูุฒุงู ุงูุญุฑุงู ุงุฒ ุจูุฏุฌู
print("\n๐ ุจุฑุฑุณ ุจูุฏุฌู ูุฒููโูุง")
print("-" * 50)
for category, expense in expenses.items():
    allocated = budget.get(category, 0)
    difference = allocated - expense
    status = "โ ุฏุฑ ูุญุฏูุฏู ุจูุฏุฌู" if difference >= 0 else "โ ุจุดโุงุฒุญุฏ ุจูุฏุฌู"
    print(f"{category}: ูุฒูู {expense:.2f} ุงุฒ ุจูุฏุฌู {allocated:.2f} ({status})")
    if difference < 0:
        print(f"  - ููุฏุงุฑ ุงุถุงู ุฎุฑุฌโุดุฏู: {-difference:.2f}")
    else:
        print(f"  - ููุฏุงุฑ ุจุงูโูุงูุฏู ุงุฒ ุจูุฏุฌู: {difference:.2f}")

# ุจุฑุฑุณ ุงูฺฉุงู ุงูุฒุงุด ูพุณโุงูุฏุงุฒ
remaining_income = income - sum(expenses.values())
can_save_more = remaining_income > 0
print("\n๐ฆ ุจุฑุฑุณ ุงูฺฉุงู ุงูุฒุงุด ูพุณโุงูุฏุงุฒ")
print("-" * 50)
if can_save_more:
    print(f"โ ุงูฺฉุงู ุงูุฒุงุด ูพุณโุงูุฏุงุฒ ูุฌูุฏ ุฏุงุฑุฏ! ููุฏุงุฑ ูุงุจู ูพุณโุงูุฏุงุฒ: {remaining_income:.2f}")
else:
    print("โ๏ธ ุงูฺฉุงู ุงูุฒุงุด ูพุณโุงูุฏุงุฒ ูุฌูุฏ ูุฏุงุฑุฏุ ูุฒููโูุง ุจุง ุฏุฑุขูุฏ ุจุฑุงุจุฑ ุง ุจุดุชุฑ ุงุณุช.")

# ููููู ุฎุฑูุฌ:
# ๐ ฺฏุฒุงุฑุด ูุงู ุดุฎุต
# --------------------------------------------------
# ๐ฐ ูุฌููุน ุฏุฑุขูุฏ: 5000000.00
# ๐ธ ูุฌููุน ูุฒููโูุง: 3200000.00
# ๐ฆ ูุฌููุน ูพุณโุงูุฏุงุฒ: 1000000.00
#
# ๐ ุจุฑุฑุณ ุจูุฏุฌู ูุฒููโูุง
# --------------------------------------------------
# ุฎูุฑุงฺฉ: ูุฒูู 800000.00 ุงุฒ ุจูุฏุฌู 1000000.00 (โ ุฏุฑ ูุญุฏูุฏู ุจูุฏุฌู)
#   - ููุฏุงุฑ ุจุงูโูุงูุฏู ุงุฒ ุจูุฏุฌู: 200000.00
# ุงุฌุงุฑู: ูุฒูู 1500000.00 ุงุฒ ุจูุฏุฌู 1500000.00 (โ ุฏุฑ ูุญุฏูุฏู ุจูุฏุฌู)
#   - ููุฏุงุฑ ุจุงูโูุงูุฏู ุงุฒ ุจูุฏุฌู: 0.00
# ุชูุฑุญ: ูุฒูู 900000.00 ุงุฒ ุจูุฏุฌู 700000.00 (โ ุจุดโุงุฒุญุฏ ุจูุฏุฌู)
#   - ููุฏุงุฑ ุงุถุงู ุฎุฑุฌโุดุฏู: 200000.00
#
# ๐ฆ ุจุฑุฑุณ ุงูฺฉุงู ุงูุฒุงุด ูพุณโุงูุฏุงุฒ
# --------------------------------------------------
# โ ุงูฺฉุงู ุงูุฒุงุด ูพุณโุงูุฏุงุฒ ูุฌูุฏ ุฏุงุฑุฏ! ููุฏุงุฑ ูุงุจู ูพุณโุงูุฏุงุฒ: 800000.00
